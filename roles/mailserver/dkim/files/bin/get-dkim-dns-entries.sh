#!/bin/sh

#   -------------------------------------------------------------
#   Nasqueron mail services
#   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#   Project:        Nasqueron
#   Created:        2017-01-14
#   License:        Trivial work, not eligible to copyright
#   Source file:    roles/mailserver/dkim/files/bin/get-dkim-dns-entries.sh
#   -------------------------------------------------------------
#
#   <auto-generated>
#       This file is managed by our rOPS SaltStack repository.
#
#       Changes to this file may cause incorrect behavior
#       and will be lost if the state is redeployed.
#   </auto-generated>

# Parses arguments
if [ $# -eq 0 ]
then
        echo "Usage: $(basename "$0") <domain>"
        exit 1
fi

DOMAIN=$1
DIR=/etc/opendkim/keys/$DOMAIN

if [ ! -d "$DIR" ]
then
	echo "Directory not found: $DIR"
	exit 2
fi

for f in "$DIR"/*.txt
do
	get-dkim-dns-entry "$f"
done
