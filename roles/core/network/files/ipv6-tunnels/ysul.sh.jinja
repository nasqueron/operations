#!/bin/sh

#   -------------------------------------------------------------
#   IPv6 connectivity
#   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#   Project:        Nasqueron
#   Created:        2017-10-20
#   License:        Trivial work, not eligible to copyright
#   Source file:    roles/core/network/files/ipv6-tunnels/ysul.sh.jinja
#   -------------------------------------------------------------
#
#   <auto-generated>
#       This file is managed by our rOPS SaltStack repository.
#
#       Changes to this file may cause incorrect behavior
#       and will be lost if the state is redeployed.
#   </auto-generated>

IFCONFIG=/sbin/ifconfig
ROUTE=/sbin/route

#   -------------------------------------------------------------
#   Hurricane Electric tunnel
#   nasqueron-1.tunnel.tserv10.par1.ipv6.he.net
#   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$IFCONFIG gif0 create
$IFCONFIG gif0 tunnel 212.83.187.132 216.66.84.42
$IFCONFIG gif0 inet6 2001:470:1f12:9e1::2 2001:470:1f12:9e1::1 prefixlen 128
$ROUTE -n add -inet6 default 2001:470:1f12:9e1::1
$IFCONFIG gif0 up

#   -------------------------------------------------------------
#   Canonical IP
#   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$IFCONFIG gif0 inet6 add 2001:470:1f13:9e1:0:c0ff:ee:1/64

#   -------------------------------------------------------------
#   Additional IP addresses
#   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# Canonical block
{%- for n in range (2, 16) %}
$IFCONFIG gif0 inet6 add 2001:470:1f13:9e1:0:c0ff:ee:{{ '%x' | format(n) }}/64 alias
{%- endfor %}

# Short block
{%- for n in range (1, 26) %}
$IFCONFIG gif0 inet6 add 2001:470:1f13:9e1::{{ '%x' | format(n) }}/64 alias
{%- endfor %}

# Varnish cache
$IFCONFIG gif0 inet6 add 2001:470:1f13:9e1::cac:7e:1/64 alias
