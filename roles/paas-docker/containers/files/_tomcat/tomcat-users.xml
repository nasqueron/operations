<?xml version="1.0" encoding="UTF-8"?>
<!--
    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Tomcat :: Users configuration
    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Project:      Nasqueron
    License:      Trivial enough, not eligible to copyright
    Source file:  roles/paas-docker/containers/files/_tomcat/tomcat-users.xml
    _____________________________________________________________

    <auto-generated>
        This file is managed by our rOPS SaltStack repository.

        Changes to this file may cause incorrect behavior
        and will be lost if the state is redeployed.
    </auto-generated>
-->
<tomcat-users xmlns="http://tomcat.apache.org/xml"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://tomcat.apache.org/xml tomcat-users.xsd"
              version="1.0">

    {% if roles is defined %}
    {% for role, role_args in roles.items() %}
    <role rolename="{{ role }}" description="{{ role_args.description }}" />
    {% endfor %}
    {% else %}
    {% for role in salt["tomcat.extract_roles_from_users"](users) %}
    <role rolename="{{ role }}" />
    {% endfor %}
    {% endif %}

    {% for username, user_args in users.items() %}
    <user
        username="{{ username }}"
        password="{{ user_args.password }}"
        roles="{{ user_args.roles | join(' ') }}"
    />
    {% endfor %}
</tomcat-users>
