#   -------------------------------------------------------------
#   KnotDNS
#   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#   Project:        Nasqueron
#   License:        Trivial work, not eligible to copyright
#   Source file:    roles/dns/knot/files/knot.conf
#   -------------------------------------------------------------
#
#   <auto-generated>
#       This file is managed by our rOPS SaltStack repository.
#
#       Changes to this file may cause incorrect behavior
#       and will be lost if the state is redeployed.
#   </auto-generated>

server:
    rundir: "/var/run/knot"
    user: knot:knot
    automatic-acl: on
    listen: [{{ all_ips | join(", ") }}]
    identity: {{ identity }}

acl:
    - id: he-net
      address: [216.218.131.2, 2001:470:600::2, 216.218.132.2, 2001:470:300::2, 216.218.133.2, 2001:470:400::2, 216.66.1.2, 2001:470:500::2, 216.66.80.18, 2001:470:600::3]
      action: transfer

log:
  - target: syslog
    any: info

remote:
    - id: he-net
      address: [216.218.130.2, 2001:470:100::2]

database:
    storage: "/var/db/knot"

template:
  - id: default
    storage: "/var/db/knot"
    file: "%s.zone"

zone:
{% for zone in zones %}
  - domain: {{ zone }}
    file: /var/db/knot/{{ zone }}.zone
    notify: [he-net]
    acl: [he-net]
{% endfor %}
