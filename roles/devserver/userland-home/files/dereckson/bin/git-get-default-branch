#!/bin/sh
if [ $# -ne 0 ]
then
	>&2 echo "Usage: $(basename "$0")"
	exit 1
fi

REPO_PATH=$(git rev-parse --show-toplevel)
REPO_RETCODE=$?

if [ $REPO_RETCODE -ne 0 ]
then
    exit $REPO_RETCODE
fi;

REPO=$(basename "$REPO_PATH")

if [ "$REPO" = "puppet" ]
then
    DEFAULT_BRANCH=production
elif [ "$REPO" = "pixelfed" ]
then
    DEFAULT_BRANCH=dev
elif [ -f $REPO_PATH/.git/arc/default-relative-commit ]
then
    DEFAULT_BRANCH=$(awk -F / '{print $(NF)}' $REPO_PATH/.git/arc/default-relative-commit)
elif git show-ref --verify --quiet refs/heads/main
then
    DEFAULT_BRANCH=main
else
    DEFAULT_BRANCH=master
fi

echo $DEFAULT_BRANCH
