#!/bin/sh

CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)
DEFAULT_BRANCH=$(git get-default-branch)

if [ "$CURRENT_BRANCH" = "$DEFAULT_BRANCH" ]; then
	echo "You're already on the default branch '$DEFAULT_BRANCH'."
	exit 1
fi

# Updates master branch if there isn't any staged change and working tree is clean
git checkout "$DEFAULT_BRANCH"

git diff-index --quiet --cached HEAD -- && \
git diff-files --quiet && git pull

git branch -D "$CURRENT_BRANCH"
